<!DOCTYPE html>
<html dir="ltr" lang="en">
<%- include("./partials/head.ejs") %>

  <body onload="onload()" id="ea-listings">
    <%- include("./partials/header.ejs") %>

      <section id="ea-listings-top">
        <div class="container">
          <h1>All EA Listings</h1>

          <p>Lorem, ipsum dolor sit amet consectetur adipisicing elit.</p>
        </div>
      </section>

      <section id="input">
        <div class="container">
          <div class="row">
            <div class="row-1.col-md-4">
              <!-- <div class="input-num col-md-4">
              <input type="number" name="number" id="num" placeholder="10" />
              <p>records per page</p>
            </div> -->
              <div class="input-text col-md-8">
                <p>search:</p>
                <input type="text" name="search" id="search" />
                <button onclick="search()" class="btn btn-lg b-ton b-ton-blu"> Search</button>
                <!-- <input type="text" name="" id="order" placeholder="Order By"> -->
                <!-- <select name="cars" id="order">
                <option value="volvo">Order by</option>
                <option value="saab">Zip Code</option>
                <option value="mercedes">State</option>
                <option value="audi">Rating</option>
              </select> -->


                <!-- <input type="text" name="" id="descend" placeholder="Descending"> -->

                <!-- <select name="descend" id="descend">
                <option value="volvo">Descending</option>
                <option value="saab">Ascending</option>
              </select> -->
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="premium" class="container">
        <% if( typeof locals.agents !=='undefined' && locals.agents.data && locals.agents.data.length > 0) { %>
          <% locals.agents.data.map((e,id)=> { %>
            <% const {firstName, lastName, city, reviewCount }=e %>
              <div class="row premium-box">
                <div class="col-md-4 col-sm-12">
                  <div class="img col-md-5">
                    <img src="/assets/files/person-img.png" alt="rating" />
                  </div>
                  <div class="txt col-md-7">
                    <h3>
                      <%= firstName %>
                        <%= lastName %>
                    </h3>
                    <p>
                      <%= city %>
                    </p>
                  </div>
                </div>
                <div class="col-md-4 col-sm-12 mid-div">
                  <!-- <h4>Premium Member</h4> -->
                  <h4> </h4>
                  <p><img src="/assets/files/star-rating.png" alt="" /> <span>
                      <%= reviewCount %> reviews
                    </span></p>
                </div>
                <div class="col-md-4 col-sm-12 b-tons">
                  <a href="" class="btn btn-lg btn-blu mt-2"> View profile</a>
                  <!-- <a href="" class="btn btn-lg btn-wht mt-2"> Website</a> -->
                </div>
              </div>
              <% })} else { %>
                <div>
                  <p>There were 0 results found for your search critera.</p>
                </div>
              <% } %>
              
      </section>
      

      <section id="bottom">
        <div class="container contain">
          <div class="row">
            <div class="col-md-3">
              <a href="/ea-listings" class="btn btn-lg b-ton b-ton-blu"> View All EAs</a>
            </div>
            <div class="col-md-3">
              <% if( typeof locals.agents !=='undefined' && locals.agents) { %>
                <% const {perPage, pages, page, total }=locals.agents %>
                  <% const start=(perPage * page) - perPage +1 %>
                    <% const end=start + perPage -1 %>
                      <p>showing <%= start || 0%> to <%= end || 0%> of <%= total || 0%> entries</p>
                      <% } %>
            </div>
            <!-- <div class="col-md-6 b-tons"> -->
            <% if( typeof locals.agents !=='undefined' ) { %>
              <% const { agents: {page, pages}, query}=locals %>
                <%- include("./partials/pagination.ejs", {page, pages, query }) %>
                  <% } %>
                    <!-- <div class="a btn b-ton-1 b-ton col-md-3 mt-5">← previous</div>
            <div class="a btn b-ton b-ton-2 col-md-1 mt-5">1</div>
            <div class="a btn b-ton b-ton-3 col-md-1 mt-5">2</div>
            <div class="a btn b-ton b-ton-4 col-md-1 mt-5">3</div>
            <div class="a btn b-ton b-ton-5 col-md-1 mt-5">4</div>
            <div class="a btn b-ton b-ton-6 col-md-1 mt-5">5</div>
            <div class="a btn b-ton-7 col-md-2 b-ton mt-5">next →</div> -->
                    <!-- </div> -->
          </div>

        </div>
      </section>
      <!-- footer section -->
      <%- include("./partials/footer.ejs") %>
        <script src="/js/custom.js"></script>

        <script>
          function search() {
            const input = document.getElementById("search").value
            console.log(input)
            window.location = `?search=${input}`
          }
          function onload() {
            const input = document.getElementById("search")
            const urlParams = new URLSearchParams(window.location.search);
            const _search = urlParams.get('search');
            input.value = _search
            input.addEventListener("keyup", function (event) {
              // Number 13 is the "Enter" key on the keyboard
              if (event.keyCode === 13) {
                search()
              }})
              // console.log(_search)
            }
        </script>
  </body>

</html>